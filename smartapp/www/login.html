{% extends "templates/web.html" %}

{% block page_content %}
<section class="login py-5">
  <div class="container">
    <div class="row justify-content-center">
      <div class="col-md-6">
        <div class="card shadow p-4">
          <h2 class="mb-4 text-center">Login</h2>
          <form id="login-form">
            <div class="mb-3">
              <label>Email</label>
              <input type="email" name="usr" class="form-control" required>
            </div>
            <div class="mb-3">
              <label>Password</label>
              <input type="password" name="pwd" class="form-control" required>
            </div>
            <button type="submit" class="btn btn-primary w-100">Login</button>
          </form>
        </div>
      </div>
    </div>
  </div>
</section>

<script>
frappe.ready(function() {
  $("#login-form").on("submit", function(e) {
    e.preventDefault();
    frappe.call({
      method: "mywebsite.www.login.custom_login",
      args: {
        usr: $("input[name='usr']").val(),
        pwd: $("input[name='pwd']").val()
      },
      callback: function(r) {
        if (r.message.status === "success") {
          window.location.href = "/subscriptions";
        } else {
          frappe.msgprint(r.message.message);
        }
      }
    });
  });
});
</script>
{% endblock %}
